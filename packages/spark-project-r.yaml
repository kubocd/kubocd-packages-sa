
apiVersion: v1alpha1
name: spark-project-r
tag: 0.1.0-p01
protected: false
schema:
  parameters:
    properties:
      projectId:  { type: string, required: true }
      serviceAccountName: { type: string, default: "spark"}
      roleName: { type: string, default: "spark"}
      kubernetesJobs:
        properties:
          manage: { type: boolean, default: true, description: "Allow the serviceAccount to manage Kubernetes jobs and cronjobs" }
      secretStore:
        properties:
          manage: { type: boolean, default: true, description: "Allow the serviceAccount to manage external-secret secretStore and externalSecrets" }
      s3access:
        properties:
          accessKey: { type: string, required: true }
          secretKey: { type: string, required: true }
      workflow:
        properties:
          enabled: { type: boolean, default: false, description: "Deploy Argo Workflow" }
          guiOidcGroups:
            description: "List of OIDC groups which will be impersonated in 'service' account on the Argo workflow server."
            items: { type: string }
      sparkOperator:
        properties:
          enabled: { type: boolean, default: true, description: "Deploy spark operator" }
modules:
  - name: main
    source:
      local:
        path: ../charts/spark-project/0.1.0
    values: |
      projectId: {{ .Parameters.projectId }}
      protected: {{ .Release.spec.protected }}
      s3access:
        accessKey: {{ .Parameters.s3access.accessKey }}
        secretKey: {{ .Parameters.s3access.secretKey }}
      workflow:
        enabled: false
        guiOidcGroups: []
      sparkOperator:
        enabled: {{ .Parameters.sparkOperator.enabled }}



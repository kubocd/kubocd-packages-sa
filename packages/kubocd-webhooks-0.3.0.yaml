

apiVersion: v1alpha1
name: kubocd-webhooks
tag: v0.3.0-p01
protected: true
description: |
  Second stage of kubocd deployment.
schema:
  parameters:
    properties:
      replicaCount: { type: integer, default: 2 }
      deployInControlPlane: { type: boolean, default: true }
      deployInServicePlane: { type: boolean, default: true }
modules:
  - name: noname
    source:
      oci:
        repository: quay.io/kubocd/charts/kubocd-wh
        tag: v0.3.0
    values: |
      image:
        {{ $redirection := imageRedirect "quay.io/kubocd/kubocd" . }}
        repository: {{ $redirection.repository }}
        pullPolicy: Always
      webhook:
        replicaCount: {{ .Parameters.replicaCount }}
        deployInControlPlane: {{ .Parameters.deployInControlPlane }}
        {{- if .Parameters.deployInServicePlane }}
        tolerations:
          - key: node-role.kubernetes.io
            operator: "Equal"
            effect: NoSchedule
            value: services
        nodeSelector:
          node-role.kubernetes.io: "services"
        {{- end }}
        logger:
          mode: dev
          level: debug
        metrics:
          enabled: false
          secured: false
dependencies:
  - certManager

